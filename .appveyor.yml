init:
  - git config --global core.autocrlf true
clone_depth: 1
environment:
  global:
    DOTNET_SKIP_FIRST_TIME_EXPERIENCE: true
    DOTNET_CLI_TELEMETRY_OPTOUT: 1
  SQ_TOKEN:
    secure: g5CtCNUG4/4//OaQCidnKFuLThMbMGKQhFgYbCECu2AJlPeV8c9mBTNfeZZy9TpN
test: off
deploy: off
os: Visual Studio 2017
before_build:
  - cmd: dotnet restore
build_script:
  - choco install "msbuild-sonarqube-runner" -y
  - ps: if (-Not $env:APPVEYOR_PULL_REQUEST_NUMBER) { MSBuild.SonarQube.Runner.exe begin /k:"midmid" /o:"midmid" /d:"sonar.host.url=https://sonarcloud.io" /d:"sonar.login=$env:SQ_TOKEN" }
  - msbuild "Configuration.MongoDb.sln"
  - ps: if (-Not $env:APPVEYOR_PULL_REQUEST_NUMBER) { MSBuild.SonarQube.Runner.exe end /d:"sonar.login=$env:SQ_TOKEN" }